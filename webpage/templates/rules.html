<h2>üìé Recommendations based on your selection</h2>

<form method="POST">
  <label for="course_id">Select a Course ID:</label>
  <select name="course_id" id="course_id">
    {% for cid in course_options %}
      <option value="{{ cid }}" {% if course_id == cid %}selected{% endif %}>{{ cid }}</option>
    {% endfor %}
  </select>
  <input type="submit" value="Find Associations">
</form>

{% if explanations %}
  <h3>Because you took: {{ selected_title or course_id }}</h3>
  <table>
    <tr>
      <th>Course</th>
      <th>Estimated likelihood</th>
      <th>vs typical</th>
      <th>Why</th>
    </tr>
    {% for row in explanations %}
    <tr>
      <td>{{ row.title }} <div style="font-size:12px;color:#666;">(ID: {{ row.consequent }})</div></td>
      <td>
        <div style="display:flex;align-items:center;gap:8px;">
          <div style="width:120px;height:8px;background:#eee;border-radius:4px;overflow:hidden;">
            <div style="width: {{ row.likelihood_pct }}%; height:8px; background:#4caf50;"></div>
          </div>
          <span>{{ row.likelihood_pct }}% <span style="color:#666;">({{ row.n_both }}/{{ row.n_selected }})</span></span>
        </div>
      </td>
      <td>{{ row.baseline_pct }}%</td>
      <td>Often taken by learners who also took your selected course.</td>
    </tr>
    {% endfor %}
  </table>

  <details style="margin-top:10px;">
    <summary>Show details (support / confidence / lift)</summary>
    <table style="margin-top:8px;">
      <tr><th>Course ID</th><th>Support</th><th>Confidence</th><th>Lift</th></tr>
      {% for row in explanations %}
        <tr>
          <td>{{ row.consequent }}</td>
          <td>{{ row.support }}</td>
          <td>{{ row.confidence }}</td>
          <td>{{ row.lift }}</td>
        </tr>
      {% endfor %}
    </table>
  </details>

  <div class="explain" style="font-size:13px;color:#555;margin-top:10px;">
    <p><strong>What these mean:</strong>
    <br><em>Estimated likelihood</em>: among learners who took your selected course, the share who also took the recommended course (with sample sizes).
    <br><em>vs typical</em>: how common the recommended course is among all learners.</p>
  </div>

{% elif course_id %}
  <p>No association-based suggestions found for this course.</p>
{% endif %}

<p style="margin-top: 16px;"><a href="/">‚Üê Back to Home</a></p>
